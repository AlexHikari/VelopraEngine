# rendering CMakeLists.txt
cmake_minimum_required(VERSION 3.8)
project(VelopraRenderer)

# Precompiled header file
set(PRECOMPILED_HEADER "${CMAKE_CURRENT_SOURCE_DIR}/include/VE_pch.h")

set(RENDERING_SOURCE_FILES
    src/VE_pch.cpp
    src/VE_RenderUtils.cpp
    src/opengl/VE_OpenGLShader.cpp
    src/opengl/VE_OpenGLTexture.cpp
    src/opengl/VE_OpenGLTextureAtlas.cpp
    src/opengl/VE_OpenGLTextureLoader.cpp
    src/opengl/VE_OpenGLTransform.cpp
    src/opengl/2d/VE_OpenGL2DRenderer.cpp
    src/opengl/2d/VE_OpenGLOrthoCamera.cpp
    src/opengl/3d/VE_OpenGLCamera.cpp
    src/opengl/3d/VE_OpenGLMesh.cpp
    src/opengl/3d/VE_OpenGLModel.cpp
    src/opengl/3d/VE_OpenGLRenderer.cpp
)
set(RENDERING_HEADER_FILES
    include/stb_image.h
    include/VE_pch.h
    include/VE_RendererAPI.h
    include/VE_RenderTypes.h
    include/VE_RenderUtils.h
    include/interfaces/VE_ICamera.h
    include/interfaces/VE_IFollowableCamera.h
    include/interfaces/VE_IMesh.h
    include/interfaces/VE_IModel.h
    include/interfaces/VE_IRenderer.h
    include/interfaces/VE_IRenderer2D.h
    include/interfaces/VE_IShader.h
    include/interfaces/VE_ITexture.h
    include/interfaces/VE_ITextureLoader.h
    include/interfaces/VE_ITransform.h
    include/interfaces/VE_IWindowSizeObserver.h
    include/opengl/VE_OpenGLShader.h
    include/opengl/VE_OpenGLTexture.h
    include/opengl/VE_OpenGLTextureAtlas.h
    include/opengl/VE_OpenGLTextureLoader.h
    include/opengl/VE_OpenGLTransform.h
    include/opengl/2d/VE_OpenGL2DRenderer.h
    include/opengl/2d/VE_OpenGLOrthoCamera.h
    include/opengl/3d/VE_OpenGLCamera.h
    include/opengl/3d/VE_OpenGLMesh.h
    include/opengl/3d/VE_OpenGLModel.h
    include/opengl/3d/VE_OpenGLRenderer.h
)

# Create the Renderer library
add_library(VelopraRenderer ${RENDERING_SOURCE_FILES} ${RENDERING_HEADER_FILES})

# Define BUILDING_RENDERER_DLL when building a shared library
if(BUILD_SHARED_LIBS)
    target_compile_definitions(VelopraRenderer PRIVATE BUILDING_RENDERER_DLL)
endif()


# Find necessary packages
find_package(OpenGL REQUIRED)
find_package(GLEW REQUIRED)
find_package(assimp REQUIRED)
find_package(glm REQUIRED)

target_link_directories(VelopraRenderer PRIVATE
    ${GLEW_INCLUDE_DIRS}
    ${GLFW_INCLUDE_DIRS}
    ${ASSIMP_INCLUDE_DIRS}
    ${GLM_INCLUDE_DIRS}
)
target_include_directories(VelopraRenderer PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}/include
)
# Link with Core module and external libraries
target_link_libraries(VelopraRenderer PRIVATE 
    VelopraCore
    GLEW::GLEW
    OpenGL::GL 
    glm::glm
    assimp::assimp
)
# Enable precompiled headers
target_precompile_headers(VelopraRenderer PRIVATE ${PRECOMPILED_HEADER})
